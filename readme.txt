电泳图可视化处理用户指南
0. 基本流程
打开图片
自动检测胶块（必要时调参数）
在右侧画布调整 ROI（缩放、平移、微调）
（可选）开启白平衡并设置参数
设置分道方式与泳道数量
设置标准道、分子量列表、Y 轴刻度
渲染当前胶块并检查结果
导出结果（裁剪图、标注图、summary.json）
1. 打开图片
支持 .jpg/.jpeg/.png/.tif/.tiff。
打开后会清空旧结果并初始化 ROI。
2. 自动检测胶块（原图）
参数：

期望胶块数量：默认 2。设为样本大致数量。
阈值块大小：默认 51（奇数）。越大越全局，越小越局部。
阈值偏移 C：默认 10。越大越严格，越小越宽松。
闭运算核大小：默认 11（奇数）。越大越能合并碎片，越小越保留分隔。
建议：

检测不到 → 减小 C，增大块大小和核。
检测过多 → 增大 C，减小核。
3. 图形化裁剪（ROI）
交互：左键拖动角点/边界调整，滚轮缩放，右键平移，方向键微调（Shift/Ctrl 加速）。
建议：ROI 应覆盖完整泳道，避免过多背景。
4. 白平衡（ROI 级别，可选）
作用：增强条带对比度，改善背景不均。

参数：

启用白平衡：建议开启。
CLAHE clipLimit：默认 2.0（推荐 1.5–2.5）。越大增强越强，噪声也更明显。
CLAHE tileSize：默认 8（推荐 6–12）。越小局部增强更强，越大更平滑。
调节策略：

先固定 tileSize=8，调 clipLimit。
条带暗 → clipLimit ↑；噪声多 → clipLimit ↓。
ROI 窄 → tileSize ↓；ROI 大 → tileSize ↑。
5. 分道参数
泳道数量：默认 16，与实际一致。
模式：
自动（含斜率）：适合条带倾斜或弯曲。
等宽：泳道规则时使用。
投影平滑窗口：默认 31。噪声多 → 增大；泳道窄 → 减小。
峰间最小间隔系数：默认 1.2。泳道过密 → 增大；泳道宽 → 减小。
等宽模式边距：左/右边距，避免边缘杂散。
6. 标准带 / 刻度
标准道序号：默认 1。
标准分子量列表：默认 180,130,100,70,55,40,35,25,15,10。
Y 轴刻度列表：为空则沿用标准列表。
搜索范围：top（仅此行以下）、bot（仅此行以上，0 表示不限制）。
Y 轴位置：左或右。
拟合逻辑：

检测标准道峰 → 匹配分子量 → IRLS 拟合 → 通过质控（R²≥0.97，RMSE≤2%H 或 20px）才绘制刻度。
7. 操作按钮
渲染当前胶块：执行裁剪、WB、分道、峰检测、拟合、绘制。
导出当前结果：输出裁剪图、标注图、summary.json。
8. 推荐参数起点
胶块检测：expected=2, thr_block=51, thr_C=10, morph_ksize=11
WB：clipLimit=2.0, tileSize=8
分道：nlanes=16, 模式=自动, smooth_px=31, min_sep_ratio=1.2
标准：ladder_lane=1，分子量列表按试剂填写。
9. 常见问题
检测不到胶块：减小 C，增大块大小和核。
分道错位：增大 smooth_px，增大 min_sep_ratio。
拟合失败：检查标准道、分子量列表、ROI 是否正确。